<h1 mat-dialog-title>View Class</h1>
<div mat-dialog-content>
  <div class="row mt-4 mb-4" *ngIf="!isBranch">
    <form [formGroup]="viewClassForm!">
      <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 mb-2">
        <mat-form-field class="example-full-width mb-3" appearance="outline">
          <mat-label>Branch</mat-label>
          <mat-select formControlName="branch" (selectionChange)="onSelectionChange($event.value)">
            <mat-option *ngFor="let branch of branchesList" [value]="branch.branchId">
              {{ branch.branchName }}
            </mat-option>
          </mat-select>
          <div class="loading-container">
            <mat-spinner *ngIf="isBranchLoading" class="spinner" diameter="20"></mat-spinner>
          </div>
          <mat-error *ngIf="viewClassForm?.get('branch')?.hasError('required')">
            Branch is required
          </mat-error>
        </mat-form-field>
      </div>
    </form>
  </div>

  <div class="row mt-4 mb-4">
    <div class="col-12">
      <div class="card">
        <div class="header">
          <h2>Classes for Level: {{ data.levelname }}</h2>
        </div>
        <div class="body">
          <p-table #dt [value]="classList" 
                  [rows]="10" 
                  [paginator]="true"
                  [rowHover]="true"
                  [globalFilterFields]="['class.classid', 'class.classname']"
                  styleClass="p-datatable-sm p-datatable-gridlines">
            <ng-template pTemplate="header">
              <tr>
                <th pSortableColumn="class.classid">Class ID <p-sortIcon field="class.classid"></p-sortIcon></th>
                <th pSortableColumn="class.classname">Class Name <p-sortIcon field="class.classname"></p-sortIcon></th>
                <th style="width: 100px">Actions</th>
              </tr>
            </ng-template>
            <ng-template pTemplate="body" let-element>
              <tr>
                <td>{{ element.class.classid }}</td>
                <td>{{ element.class.classname }}</td>
                <td>
                  <button mat-icon-button color="warn" (click)="removeClass(element)" matTooltip="Remove Class">
                    <mat-icon>delete</mat-icon>
                  </button>
                </td>
              </tr>
            </ng-template>
            <ng-template pTemplate="emptymessage">
              <tr>
                <td colspan="3" class="text-center">No classes found for this level.</td>
              </tr>
            </ng-template>
          </p-table>
        </div>
      </div>
    </div>
  </div>
</div>
<div mat-dialog-actions>
  <button mat-raised-button type="button" (click)="closeDialog()" color="warn">Close</button>
</div>